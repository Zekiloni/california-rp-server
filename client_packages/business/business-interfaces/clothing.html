<!DOCTYPE html>
<html>
<head>
   <!-- meta tags-->
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

   <!-- source -->
   <link rel="stylesheet" type="text/css" href="src/vendor/css/fonts.css" />
   <link rel="stylesheet" type="text/css" href="src/vendor/css/font-awesome.css" />

   <link rel="stylesheet" type="text/css" href="src/styles/clothing.css" />

</head>
<body>
   <div id="clothing">
      
      <div class="right">
         <ul class="navigation">

            <i v-on:click="Close()" class="close fa fa-times"></i>

            <li v-on:click="Page('home')" :class="{ 'active' : isActive('home') }"> <i class="fa fa-cart-plus"> </i> </li>
            <li v-on:click="Page('Tops')" :class="{ 'active' : isActive('Tops') }"> <i class="fas fa-tshirt"></i> </li>
            <li v-on:click="Page('Undershirt')" :class="{ 'active' : isActive('Undershirt') }"> <i class="fas fa-tshirt"></i> </li>
            <li v-on:click="Page('Pants')" :class="{ 'active' : isActive('Pants') }"> <i class="fas fa-walking"></i> </li>
            <li v-on:click="Page('Shoes')" :class="{ 'active' : isActive('Shoes') }"> <i class="fas fa-shoe-prints"></i> </li>

            <li v-on:click="Page('Watch')" :class="{ 'active' : isActive('Watch') }"> <i class="fas fa-clock"></i> </li>
            <li v-on:click="Page('Glasses')" :class="{ 'active' : isActive('Glasses') }"> <i class="fas fa-glasses"></i> </li>
            <li v-on:click="Page('Ears')" :class="{ 'active' : isActive('Ears') }"> <i class="fa fa-deaf"></i> </li>
            <li v-on:click="Page('Bracelet')" :class="{ 'active' : isActive('Bracelet') }"> <i class="fas fa-ring"></i> </li>
            <li v-on:click="Page('Hat')" :class="{ 'active' : isActive('Hat') }"> <i class="fab fa-redhat"></i> </li>
         </ul>

         <div class="page">
            <transition name="scale" mode="out-in">
               <div v-if="page == 'home'" class="info" :key="page">
                  <h4> Prodavnica odeće </h4>
                  <h2 class="business-name"> {{ Business.Name }} </h2>
                  <div class="buy">
                     <h3> cena </h3>
                     <h2 class="price"> {{ Dollars(Cart()) }} </h2>
                     <button class="buy" v-on:click="Buy()" :disabled="Cart() < 1"> Potvrdi Kupovinu </button>
                  </div>
               </div>

               <div v-else class="window" :key="page" >
                  <h2 class="title"> {{ pages[page] }} </h2>
                  <div class="drawable">
                     <h5> Model </h5>
                     <button v-on:click="Drawable(page, 0)"> - </button>
                     <h2> {{ Clothings[page].value }} </h2>
                     <button v-on:click="Drawable(page, 1)"> + </button>
                  </div>
                  <div class="texture">
                     <h5> Tekstura </h5>
                     <button v-on:click="Texture(page, 0)"> - </button>
                     <h2> {{ Clothings[page].texture }} </h2>
                     <button v-on:click="Texture(page, 1)"> + </button>
                  </div>
               </div>
            </transition>
         </div>
      </div>
   </div>
      
   <!-- scripts -->
   <script src="src/vendor/js/vue.js"></script>
   <script>

      let clothing = new Vue({
         el: '#clothing',
         data: {      

            Business: {
               Name: 'ime',
               id: null,
               Multiplier: 2.5,
            },

            page: 'home',
            pages: { 
               'Tops': 'Gornji Delovi',
               'Undershirt': 'Podmajice / Potkošulje',
               'Pants': 'Donji Delovi', 
               'Shoes': 'Obuća',
               'Bag': 'Torbe',
               // 'armour': 'Pancir',
               'Hat': 'Šešir',
               'Glasses': 'Naoćare',
               'Ears': 'Uši',
               'Watch': 'Satovi',
               'Bracelet': 'Narukvice'
            },

            Clothings: {
               'Tops': { index: 11, value: 0, texture: 0, max: { value: 362, texture: 100 } },
               'Undershirt': { index: 8, value: 0, texture: 0, max: { value: 178, texture: 100 } },
               'Pants': { index: 4, value: 0, texture: 0, max: { value: 133, texture: 100 } }, 
               'Shoes': { index: 6, value: 0, texture: 0, max: { value: 98, texture: 100 } },
               'Bag': { index: 0, value: 0, texture: 0, max: { value: 100, texture: 100 } },
               // 'armour': { index: 0, value: 0, texture: 0, max: { value: 100, texture: 100 } },
               'Hat': { index: 0, value: 0, texture: 0, max: { value: 100, texture: 100 } },
               'Glasses': { index: 0, value: 0, texture: 0, max: { value: 100, texture: 100 } },
               'Ears': { index: 0, value: 0, texture: 0, max: { value: 100, texture: 100 } },
               'Watch': { index: 0, value: 0, texture: 0, max: { value: 100, texture: 100 } },
               'Bracelet': { index: 0, value: 0, texture: 0, max: { value: 100, texture: 100 } },
            }
         },

         created () {
            window.addEventListener('wheel', this.Zoom);
         },

         methods: { 

            Close: () => { mp.trigger('client:business.clothing:menu'); }, 

            Page: function (i) { this.page = i; this.anim = true; },

            isActive: function (i) { return this.page == i ? true : false; },

            Cart: function () { 
               let bill = 0;
               for (let i in this.Clothings) { 
                  const Item = this.Clothings[i];
                  if (Item.value != 0) bill += this.Business.Multiplier;
               }
               return bill;
            },

            Items: function () { 
               let buyed = [];
               for (const i in this.Clothings) {
                  const Item = this.Clothings[i];
                  if (Item.value != 0) { 
                     buyed.push({ component: i, drawable: Item.value, texture: Item.texture });
                  }
               }
               return buyed;
            },

            Zoom: function (event) { mp.trigger('client:player.camera:zoom', event.deltaY); },

            Drawable: function (x, i) { 
               if (i == 0) { this.Clothings[x].value --; if (this.Clothings[x].value < 0) this.Clothings[x].value = 0; }
               else if (i == 1) { this.Clothings[x].value ++; if (this.Clothings[x].value >= this.Clothings[x].max.value) this.Clothings[x].value = this.Clothings[x].max.value; }
               mp.trigger('client:business.clothing:model:preview', x, parseInt(this.Clothings[x].index), parseInt(this.Clothings[x].value));
            },

            Texture: function (x, i) { 
               if (i == 0) { this.Clothings[x].texture --; if (this.Clothings[x].texture < 0) this.Clothings[x].texture = 0; }
               else if (i == 1) { this.Clothings[x].texture ++; if (this.Clothings[x].texture >= this.Clothings[x].max.texture) this.Clothings[x].texture = this.Clothings[x].max.texture; }
               mp.trigger('client:business.clothing:texture:preview', x, parseInt(this.Clothings[x].index), parseInt(this.Clothings[x].texture));
            },

            Buy: function () { 
               mp.trigger('client:business.clothing:buy', this.Cart(), JSON.stringify(this.Items()), this.Business.id);
            },

            Dollars: (i) => { return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(i); }
         }
      })
   </script>
</body>     
</html>
